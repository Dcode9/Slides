<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pr√©sentation de Fran√ßais</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel (for JSX) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Custom Fonts -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Patrick+Hand&family=Playfair+Display:wght@700&family=Permanent+Marker&display=swap');

        /* Custom Styles from previous React component */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        .paper-texture-bg {
            background-color: #f8f5e6;
            background-image: url("https://www.transparenttextures.com/patterns/cream-paper.png");
            background-blend-mode: multiply;
        }
        .crumpled-texture {
            background-color: #fff;
            background-image: url("https://www.transparenttextures.com/patterns/crinkle-paper.png");
            background-size: 400px;
        }

        .clip-torn-1 { clip-path: polygon(2% 0%, 98% 2%, 100% 95%, 95% 100%, 5% 98%, 0% 5%); }
        .clip-torn-2 { clip-path: polygon(0% 0%, 100% 0%, 95% 90%, 85% 100%, 10% 95%, 0% 85%); }

        .shadow-layered { filter: drop-shadow(2px 4px 6px rgba(0,0,0,0.15)); }
        
        .pin-container {
            position: absolute; top: -15px; left: 50%; transform: translateX(-50%);
            z-index: 100; pointer-events: none;
        }
        .pin-head {
            width: 24px; height: 24px; border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, #ff6b6b, #c92a2a);
            box-shadow: 2px 2px 5px rgba(0,0,0,0.3), inset 2px 2px 5px rgba(255,255,255,0.4);
        }
        .pin-shadow {
            position: absolute; top: 5px; left: 5px; width: 20px; height: 20px;
            background: rgba(0,0,0,0.2); border-radius: 50%;
            transform: skewX(45deg); filter: blur(2px); z-index: -1;
        }

        .thread {
            position: absolute; background: #d63031; height: 3px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1); transform-origin: 0 50%;
            z-index: 0; opacity: 0.9; pointer-events: none;
        }

        @keyframes float-continuous {
            0% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(10px, -15px) rotate(5deg); }
            50% { transform: translate(-5px, 10px) rotate(-2deg); }
            75% { transform: translate(-15px, -5px) rotate(3deg); }
            100% { transform: translate(0, 0) rotate(0deg); }
        }
        .animate-float-bg { animation: float-continuous 8s ease-in-out infinite; }

        .slide-enter-element { opacity: 0; animation: unfold-pop 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards; }
        .slide-exit-element { animation: crumple-throw 0.7s ease-in forwards; }

        @keyframes unfold-pop {
            0% { transform: scale(0.2) rotate(-5deg); opacity: 0; }
            100% { transform: scale(1) rotate(var(--final-rotation, 0deg)); opacity: 1; }
        }
        @keyframes crumple-throw {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(0.3) rotate(20deg) translate(500px, 800px); opacity: 0; }
        }

        .font-marker { font-family: 'Permanent Marker', cursive; }
        .font-serif { font-family: 'Playfair Display', serif; }
        .font-hand { font-family: 'Patrick Hand', cursive; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- ICONS (SVG Components) ---
        const ArrowLeft = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>
        );
        const ArrowRight = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
        );
        const Maximize2 = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" x2="14" y1="3" y2="10"/><line x1="3" x2="10" y1="21" y2="14"/></svg>
        );
        const RotateCcw = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/></svg>
        );

        // --- DATA ---
        const slidesData = [
            {
                id: 'welcome',
                type: 'hero',
                title: "Bienvenue",
                subtitle: "Pr√©sentation de Fran√ßais",
                bgConfig: { count: 25, spread: 'center' }
            },
            {
                id: 'group-intro',
                type: 'intro-split',
                personName: "Le Groupe",
                title: "Nos Loisirs",
                content: "Nous sommes quatre amis avec des passions tr√®s diff√©rentes. De la technologie au sport, en passant par l'art, voici ce qui nous anime au quotidien.",
                image: "https://images.unsplash.com/photo-1529156069898-49953e39b3ac?auto=format&fit=crop&q=80&w=800",
                bgConfig: { count: 20, spread: 'edges' }
            },
            {
                id: 'dhairya',
                type: 'dhairya-tech',
                personName: "Dhairya Shah",
                title: "Technologie & Innovation",
                content: [
                    "Je suis passionn√© par le codage et le d√©veloppement web.",
                    "Cr√©er des sites en HTML et CSS est mon activit√© favorite.",
                    "J'aime r√©soudre des probl√®mes complexes avec la logique.",
                    "L'intelligence artificielle me fascine √©norm√©ment."
                ],
                stickers: ['üíª', '‚ö°', 'üåê'],
                bgConfig: { count: 30, spread: 'random' }
            },
            {
                id: 'person2',
                type: 'polaroids',
                personName: "Aarav",
                title: "L'Explorateur Sportif",
                items: [
                    { 
                        title: "Le Cricket", 
                        desc: "Esprit d'√©quipe", 
                        img: "https://images.unsplash.com/photo-1531415074968-036ba1b575da?auto=format&fit=crop&q=80&w=400" 
                    },
                    { 
                        title: "Les Voyages", 
                        desc: "D√©couvrir le monde", 
                        img: "https://images.unsplash.com/photo-1476514525535-07fb3b4ae5f1?auto=format&fit=crop&q=80&w=400" 
                    }
                ],
                bgConfig: { count: 20, spread: 'corners' }
            },
            {
                id: 'person3',
                type: 'paper-note',
                personName: "Rohan",
                title: "L'Artiste Polyvalent",
                text: "J'ai plusieurs passe-temps que j'appr√©cie √©norm√©ment. L'un de mes pr√©f√©r√©s est la guitare üé∏. J'aime particuli√®rement jouer du rock. J'aime aussi peindre üé® de nouveaux paysages et des sc√®nes complexes de m√©moire. J'aime √©galement beaucoup jouer au basket üèÄ tous les jours.",
                stickers: ['üé∏', 'üé®', 'üèÄ'],
                bg: 'bg-yellow-50',
                bgConfig: { count: 25, spread: 'random' }
            },
            {
                id: 'person4',
                type: 'paper-note',
                personName: "Ishaan",
                title: "Le Strat√®ge (Badminton)",
                text: "Mon passe-temps favori est le badminton üè∏. C'est un sport rapide qui demande adresse et strat√©gie. Le score est de 21 points. Je pratique ce sport depuis quatre ans et j'adore la comp√©tition, que ce soit en simple ou en double.",
                stickers: ['üè∏', 'ü•á', 'üëü'],
                bg: 'bg-emerald-50',
                bgConfig: { count: 18, spread: 'edges' }
            },
            {
                id: 'mindmap',
                type: 'mindmap',
                title: "Chapitre 6: Les Loisirs",
                nodes: [
                    { id: 'root', text: "Les Loisirs", img: "https://images.unsplash.com/photo-1523580494863-6f3031224c94?auto=format&fit=crop&q=80&w=300", x: 42, y: 5, w: 250, rotate: -1, type: 'root' },
                    { id: 'sport', text: "Faire du...", img: "https://images.unsplash.com/photo-1517649763962-0c623066013b?auto=format&fit=crop&q=80&w=300", x: 10, y: 35, w: 200, rotate: 3, parent: 'root' },
                    { id: 'game', text: "Jouer √†...", img: "https://images.unsplash.com/photo-1606166325683-16b7dd22d257?auto=format&fit=crop&q=80&w=300", x: 75, y: 40, w: 200, rotate: -2, parent: 'root' },
                    { id: 'music', text: "Jouer de...", img: "https://images.unsplash.com/photo-1511379938547-c1f69419868d?auto=format&fit=crop&q=80&w=300", x: 45, y: 75, w: 220, rotate: 1, parent: 'root' },
                    { id: 's-swim', text: "Natation", img: "https://images.unsplash.com/photo-1530549387789-4c1017266635?auto=format&fit=crop&q=80&w=200", x: 2, y: 70, w: 160, rotate: -4, parent: 'sport' },
                    { id: 's-ski', text: "Ski", img: "https://images.unsplash.com/photo-1551698618-1dfe5d97d256?auto=format&fit=crop&q=80&w=200", x: 20, y: 80, w: 160, rotate: 2, parent: 'sport' },
                    { id: 'g-foot', text: "Football", img: "https://images.unsplash.com/photo-1579952363873-27f3bde9be2b?auto=format&fit=crop&q=80&w=200", x: 65, y: 85, w: 160, rotate: -3, parent: 'game' },
                    { id: 'g-chess', text: "√âchecs", img: "https://images.unsplash.com/photo-1529699211952-734e80c4d42b?auto=format&fit=crop&q=80&w=200", x: 85, y: 75, w: 160, rotate: 4, parent: 'game' },
                    { id: 'm-guit', text: "Guitare", img: "https://images.unsplash.com/photo-1525201548942-d8732f6617a0?auto=format&fit=crop&q=80&w=200", x: 35, y: 110, w: 160, rotate: -2, parent: 'music' },
                    { id: 'm-piano', text: "Piano", img: "https://images.unsplash.com/photo-1520523839897-bd0b52f945a0?auto=format&fit=crop&q=80&w=200", x: 60, y: 110, w: 160, rotate: 3, parent: 'music' },
                ],
                bgConfig: { count: 15, spread: 'edges' }
            },
            {
                id: 'end',
                type: 'hero',
                title: "Merci Beaucoup",
                subtitle: "Fin",
                bgConfig: { count: 40, spread: 'center' }
            }
        ];

        // --- COMPONENTS ---
        const Pin = ({ color = "#e53e3e" }) => (
            <div className="pin-container">
                <div className="pin-shadow"></div>
                <div className="pin-head" style={{ background: `radial-gradient(circle at 30% 30%, #ff8f8f, ${color})` }}></div>
            </div>
        );

        const Thread = ({ x1, y1, x2, y2 }) => {
            const length = Math.hypot(x2 - x1, y2 - y1);
            const angle = Math.atan2(y2 - y1, x2 - x1) * 180 / Math.PI;
            return (
                <div 
                    className="thread"
                    style={{
                        left: `${x1}%`,
                        top: `${y1}%`,
                        width: `${length}%`,
                        transform: `rotate(${angle}deg)`
                    }}
                />
            );
        };

        const NameTag = ({ name }) => (
            <div className="absolute -top-6 -left-6 bg-white border border-slate-200 shadow-md px-4 py-1 transform -rotate-6 z-[100] rounded-sm pointer-events-none">
                <div className="absolute -top-3 left-1/2 transform -translate-x-1/2">
                    <div className="w-12 h-4 bg-slate-200/50 blur-sm"></div>
                </div>
                <span className="font-hand font-bold text-lg text-slate-800">{name}</span>
            </div>
        );

        const BackgroundManager = ({ config }) => {
            const pool = useMemo(() => {
                const colors = ['bg-rose-300', 'bg-amber-300', 'bg-emerald-300', 'bg-blue-300', 'bg-violet-300', 'bg-orange-300'];
                const shapes = ['rounded-full', 'rounded-lg', 'clip-blob-1', 'clip-blob-2', 'rounded-3xl'];
                return Array.from({ length: 50 }).map((_, i) => ({
                    id: i,
                    shape: shapes[i % shapes.length],
                    color: colors[i % colors.length],
                    size: 30 + Math.random() * 80,
                    zIndex: 0
                }));
            }, []);
            
            const activeElements = useMemo(() => {
                return pool.map((el, i) => {
                    const isActive = i < config.count;
                    let targetX, targetY, targetRot;
                    
                    if (!isActive) {
                        const side = i % 4;
                        if (side === 0) { targetX = -20; targetY = Math.random() * 100; }
                        else if (side === 1) { targetX = 120; targetY = Math.random() * 100; }
                        else if (side === 2) { targetX = Math.random() * 100; targetY = -20; }
                        else { targetX = Math.random() * 100; targetY = 120; }
                        targetRot = Math.random() * 720;
                    } else {
                        if (config.spread === 'center') {
                            targetX = 20 + Math.random() * 60;
                            targetY = 20 + Math.random() * 60;
                        } else if (config.spread === 'edges') {
                            targetX = Math.random() > 0.5 ? Math.random() * 20 : 80 + Math.random() * 20;
                            targetY = Math.random() * 100;
                        } else if (config.spread === 'corners') {
                            targetX = Math.random() > 0.5 ? Math.random() * 20 : 80 + Math.random() * 20;
                            targetY = Math.random() > 0.5 ? Math.random() * 20 : 80 + Math.random() * 20;
                        } else if (config.spread === 'random') {
                            targetX = Math.random() * 90;
                            targetY = Math.random() * 90;
                        } else {
                            targetX = Math.random() * 100;
                            targetY = Math.random() * 100;
                        }
                        targetRot = Math.random() * 360;
                    }
                    return { ...el, isActive, left: targetX, top: targetY, rotation: targetRot };
                });
            }, [pool, config]);

            return (
                <div className="absolute inset-0 pointer-events-none overflow-hidden z-0">
                    {activeElements.map((el) => (
                        <div
                            key={el.id}
                            className={`absolute transition-all duration-[1500ms] ease-in-out ${el.color} ${el.shape} mix-blend-multiply shadow-sm`}
                            style={{
                                left: `${el.left}%`,
                                top: `${el.top}%`,
                                width: `${el.size}px`,
                                height: `${el.size}px`,
                                opacity: el.isActive ? 0.6 : 0,
                                zIndex: el.zIndex,
                                transform: `translate(-50%, -50%) rotate(${el.rotation}deg)`
                            }}
                        >
                            <div className="w-full h-full animate-float-bg"></div>
                        </div>
                    ))}
                </div>
            );
        };

        const SlideContent = ({ data, isExiting }) => {
            const animationClass = isExiting ? 'slide-exit-element' : 'slide-enter-element';

            if (data.type === 'hero') {
                return (
                    <div className="relative z-10 flex flex-col items-center justify-center h-full w-full">
                        <div className={`relative max-w-4xl rotate-2 ${animationClass}`} style={{ '--final-rotation': '2deg' }}>
                            <Pin color="#d63031" />
                            <div className="bg-white p-12 md:p-16 clip-torn-2 shadow-layered crumpled-texture relative">
                                <h1 className="text-7xl md:text-9xl font-marker text-slate-800 mb-6 text-center leading-normal">
                                    {data.title}
                                </h1>
                                <div className="w-full h-2 bg-amber-400 mb-6 rounded-full transform -rotate-1"></div>
                                <p className="text-3xl md:text-4xl font-hand text-slate-600 text-center pb-4">{data.subtitle}</p>
                            </div>
                        </div>
                    </div>
                );
            }

            if (data.type === 'intro-split') {
                return (
                    <div className="h-full w-full flex flex-col md:flex-row items-center justify-center gap-12 p-8 relative z-10">
                        <div className={`flex-1 max-w-md relative rotate-1 ${animationClass}`} style={{ animationDelay: '0.1s', '--final-rotation': '1deg' }}>
                            <Pin color="#0984e3" />
                            {data.personName && <NameTag name={data.personName} />}
                            <div className="bg-white p-8 clip-torn-1 shadow-layered crumpled-texture relative z-0">
                                <h2 className="text-5xl font-serif text-slate-800 mb-6 mt-4">{data.title}</h2>
                                <p className="text-2xl font-hand leading-relaxed text-slate-800 font-bold opacity-80">{data.content}</p>
                            </div>
                        </div>
                        <div className={`flex-1 max-w-md relative group ${animationClass}`} style={{ animationDelay: '0.3s', '--final-rotation': '-3deg' }}>
                            <div className="relative bg-white p-3 pb-12 shadow-layered -rotate-3 transition-transform crumpled-texture">
                                <div className="overflow-hidden h-64 w-full bg-slate-200 relative">
                                    <img src={data.image} alt="Intro" className="w-full h-full object-cover" />
                                    <div className="absolute inset-0 shadow-inner"></div>
                                </div>
                                <p className="absolute bottom-4 left-0 right-0 text-center font-hand text-xl text-slate-500">Notre Groupe</p>
                                <Pin color="#fdcb6e" />
                            </div>
                        </div>
                    </div>
                );
            }

            if (data.type === 'dhairya-tech') {
                return (
                    <div className="h-full w-full flex items-center justify-center p-4 relative z-10">
                        <div className={`relative max-w-3xl w-full transform rotate-1 ${animationClass}`} style={{ '--final-rotation': '-1deg' }}>
                            <Pin color="#2d3436" />
                            <NameTag name={data.personName} />
                            <div className="p-10 bg-blue-50 clip-torn-1 shadow-layered crumpled-texture relative z-0">
                                <h2 className="text-4xl md:text-5xl font-marker text-slate-900 mb-6 text-center">{data.title}</h2>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div className="bg-white p-4 shadow-sm rotate-1 border border-slate-200">
                                        <code className="text-sm text-blue-600 block mb-2">&lt;Passion /&gt;</code>
                                        <ul className="list-disc pl-5 font-hand text-xl text-slate-800 leading-loose">
                                            {data.content.slice(0,2).map((c, i) => <li key={i}>{c}</li>)}
                                        </ul>
                                    </div>
                                    <div className="bg-white p-4 shadow-sm -rotate-1 border border-slate-200">
                                        <code className="text-sm text-green-600 block mb-2">// Skills</code>
                                        <ul className="list-disc pl-5 font-hand text-xl text-slate-800 leading-loose">
                                            {data.content.slice(2).map((c, i) => <li key={i}>{c}</li>)}
                                        </ul>
                                    </div>
                                </div>
                                <div className="mt-8 flex justify-center gap-6 text-4xl">
                                    {data.stickers.map((s, i) => <span key={i} className="animate-bounce" style={{ animationDelay: `${i*0.2}s` }}>{s}</span>)}
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            if (data.type === 'polaroids') {
                return (
                    <div className="h-full w-full flex flex-col items-center justify-center relative z-10">
                        <div className={`relative mb-8 transform -rotate-2 ${animationClass}`} style={{ '--final-rotation': '-2deg' }}>
                            <Pin />
                            <NameTag name={data.personName} />
                            <div className="bg-white px-8 py-3 shadow-layered rounded-sm border-2 border-slate-100 crumpled-texture relative z-0">
                                <h2 className="text-5xl font-marker text-slate-800">{data.title}</h2>
                            </div>
                        </div>
                        <div className="flex flex-wrap justify-center gap-12">
                            {data.items.map((item, idx) => (
                                <div 
                                    key={idx} 
                                    className={`relative w-72 transform ${animationClass}`}
                                    style={{ animationDelay: `${(idx+1)*0.2}s`, '--final-rotation': idx % 2 === 0 ? '3deg' : '-3deg' }}
                                >
                                    <Pin color={idx === 0 ? "#00b894" : "#e17055"} />
                                    <div className="bg-white p-4 pb-16 shadow-layered transition-all hover:scale-110 hover:z-20 crumpled-texture relative z-0">
                                        <div className="w-full h-60 bg-slate-100 mb-4 overflow-hidden relative">
                                            <img src={item.img} alt={item.title} className="w-full h-full object-cover" />
                                            <div className="absolute inset-0 border-[1px] border-black/10"></div>
                                        </div>
                                        <h3 className="text-2xl font-hand font-bold text-center text-slate-800">{item.title}</h3>
                                        <p className="text-center font-hand text-slate-500">{item.desc}</p>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                );
            }

            if (data.type === 'paper-note') {
                return (
                    <div className="h-full w-full flex items-center justify-center p-4 relative z-10">
                        <div className={`relative max-w-4xl w-full transform rotate-1 ${animationClass}`} style={{ '--final-rotation': '1deg' }}>
                            <Pin color="#6c5ce7" />
                            <NameTag name={data.personName} />
                            <div className="absolute -top-4 left-20 w-32 h-12 bg-white/40 transform -rotate-3 backdrop-blur-sm shadow-sm border-l border-r border-white/60 pointer-events-none z-50"></div>
                            <div className="absolute -bottom-4 right-20 w-32 h-12 bg-white/40 transform rotate-2 backdrop-blur-sm shadow-sm border-l border-r border-white/60 pointer-events-none z-50"></div>
                            <div className={`p-10 md:p-14 ${data.bg} clip-torn-2 shadow-layered crumpled-texture relative z-0`}>
                                <div className="flex justify-between items-start mb-6 border-b-2 border-dashed border-slate-400 pb-4">
                                    <h2 className="text-4xl md:text-5xl font-serif text-slate-900">{data.title}</h2>
                                    <div className="text-4xl animate-bounce">{data.stickers[0]}</div>
                                </div>
                                <div className="pr-4">
                                    <p className="text-2xl md:text-3xl font-hand leading-loose text-slate-900 text-justify font-bold tracking-wide opacity-90">
                                        {data.text}
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            if (data.type === 'mindmap') {
                return (
                    <div className={`absolute inset-0 w-full h-full overflow-hidden ${animationClass}`} style={{ '--final-rotation': '0deg', animationDelay: '0.1s' }}>
                        <div className="absolute top-4 left-4 z-40 relative -rotate-1">
                            <Pin />
                            <div className="bg-white p-4 shadow-layered rounded-sm border border-slate-200 crumpled-texture">
                                <h2 className="text-3xl font-marker text-slate-800">{data.title}</h2>
                            </div>
                        </div>
                        <div className="w-full h-full overflow-auto relative cursor-grab active:cursor-grabbing custom-cursor no-scrollbar">
                            <div className="relative min-w-[1200px] min-h-[1200px] w-[150%] h-[150%]">
                                {data.nodes.filter(n => n.parent).map(node => {
                                    const parent = data.nodes.find(p => p.id === node.parent);
                                    const startX = parent.x + (parent.w / 1200 * 100 / 2);
                                    const startY = parent.y; 
                                    const endX = node.x + (node.w / 1200 * 100 / 2);
                                    const endY = node.y;
                                    return <Thread key={`thread-${node.id}`} x1={startX} y1={startY} x2={endX} y2={endY} />;
                                })}
                                {data.nodes.map((node) => (
                                    <div 
                                        key={node.id}
                                        className="absolute flex flex-col items-center transition-transform hover:z-[60] hover:scale-105"
                                        style={{
                                            left: `${node.x}%`,
                                            top: `${node.y}%`,
                                            width: `${node.w}px`,
                                            transform: `rotate(${node.rotate}deg)`,
                                            zIndex: 10
                                        }}
                                    >
                                        <Pin color={node.type === 'root' ? '#d63031' : '#0984e3'} />
                                        <div className="bg-white p-2 shadow-layered crumpled-texture w-full">
                                            <div className="w-full aspect-video bg-slate-100 mb-2 overflow-hidden rounded-sm relative z-0">
                                                <img src={node.img} alt={node.text} className="w-full h-full object-cover" />
                                                <div className="absolute inset-0 bg-gradient-to-tr from-transparent to-white/30 opacity-50"></div>
                                            </div>
                                            <span className={`text-center font-hand font-bold text-slate-900 block ${node.type === 'root' ? 'text-2xl' : 'text-xl'}`}>
                                                {node.text}
                                            </span>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                );
            }
            return null;
        };

        const LoadingScreen = ({ progress }) => (
            <div className="fixed inset-0 z-[200] flex flex-col items-center justify-center paper-texture-bg">
                <div className="relative w-24 h-24 mb-6">
                    <div className="absolute inset-0 border-4 border-slate-300 rounded-full"></div>
                    <div className="absolute inset-0 border-4 border-rose-500 rounded-full border-t-transparent animate-spin"></div>
                    <Pin color="#d63031" />
                </div>
                <h2 className="font-marker text-3xl text-slate-800 animate-pulse">Chargement...</h2>
                <p className="font-hand text-xl text-slate-600 mt-2">{Math.round(progress)}%</p>
            </div>
        );

        function App() {
            const [currentIndex, setCurrentIndex] = useState(0);
            const [animState, setAnimState] = useState('idle');
            const [isFullScreen, setIsFullScreen] = useState(false);
            const [isLoading, setIsLoading] = useState(true);
            const [loadProgress, setLoadProgress] = useState(0);

            useEffect(() => {
                const imageUrls = [];
                slidesData.forEach(slide => {
                    if (slide.image) imageUrls.push(slide.image);
                    if (slide.items) slide.items.forEach(i => imageUrls.push(i.img));
                    if (slide.nodes) slide.nodes.forEach(n => imageUrls.push(n.img));
                });

                if (imageUrls.length === 0) {
                    setIsLoading(false);
                    return;
                }

                let loadedCount = 0;
                const total = imageUrls.length;

                const checkDone = () => {
                    loadedCount++;
                    const p = (loadedCount / total) * 100;
                    setLoadProgress(p);
                    if (loadedCount >= total) {
                        setTimeout(() => setIsLoading(false), 500);
                    }
                };

                imageUrls.forEach(url => {
                    const img = new Image();
                    img.src = url;
                    img.onload = checkDone;
                    img.onerror = checkDone;
                });
            }, []);

            const handleNext = () => {
                if (currentIndex < slidesData.length - 1 && animState === 'idle') {
                    setAnimState('exiting');
                    setTimeout(() => {
                        setCurrentIndex(prev => prev + 1);
                        setAnimState('entering');
                        setTimeout(() => setAnimState('idle'), 800);
                    }, 700);
                }
            };

            const handlePrev = () => {
                if (currentIndex > 0 && animState === 'idle') {
                    setAnimState('exiting');
                    setTimeout(() => {
                        setCurrentIndex(prev => prev - 1);
                        setAnimState('entering');
                        setTimeout(() => setAnimState('idle'), 800);
                    }, 700);
                }
            };

            useEffect(() => {
                const handleKeyDown = (e) => {
                    if (isLoading) return;
                    if (e.key === 'ArrowRight' || e.key === ' ') handleNext();
                    if (e.key === 'ArrowLeft') handlePrev();
                };
                window.addEventListener('keydown', handleKeyDown);
                return () => window.removeEventListener('keydown', handleKeyDown);
            }, [currentIndex, animState, isLoading]);

            const currentSlide = slidesData[currentIndex];

            if (isLoading) return <LoadingScreen progress={loadProgress} />;

            return (
                <div className={`w-full h-screen overflow-hidden paper-texture-bg relative flex flex-col ${isFullScreen ? 'p-0' : 'p-4'}`}>
                    <BackgroundManager config={currentSlide.bgConfig} />
                    <div className={`flex-1 relative w-full h-full mx-auto rounded-xl overflow-hidden backdrop-blur-[1px] shadow-inner perspective-1000 z-10 transition-all duration-500 ${isFullScreen ? 'border-0' : 'border-0 md:border-4 border-slate-800/5'}`}>
                        <div className="w-full h-full absolute inset-0 flex items-center justify-center">
                            <div key={currentIndex} className="w-full h-full">
                                <SlideContent data={currentSlide} isExiting={animState === 'exiting'} />
                            </div>
                        </div>

                        {!isFullScreen && (
                            <div className="absolute top-4 right-4 z-[100] flex gap-2">
                                <button onClick={() => setIsFullScreen(true)} className="p-2 bg-white rounded-full shadow-lg border border-slate-200 hover:bg-slate-50 transition-transform hover:scale-110">
                                    <Maximize2 size={18} />
                                </button>
                                <button onClick={() => window.location.reload()} className="p-2 bg-white rounded-full shadow-lg border border-slate-200 hover:bg-slate-50 transition-transform hover:scale-110">
                                    <RotateCcw size={18} />
                                </button>
                            </div>
                        )}

                        {!isFullScreen && (
                            <div className="absolute bottom-6 left-1/2 transform -translate-x-1/2 z-[100] flex items-center gap-6 bg-white/90 px-6 py-2 rounded-full shadow-layered border border-slate-200">
                                <button onClick={handlePrev} disabled={currentIndex === 0 || animState !== 'idle'} className={`p-3 rounded-full hover:bg-slate-100 transition-colors ${currentIndex === 0 ? 'opacity-30' : ''}`}>
                                    <ArrowLeft size={24} className="text-slate-800" />
                                </button>
                                <div className="font-marker text-xl text-slate-800 w-16 text-center">{currentIndex + 1} / {slidesData.length}</div>
                                <button onClick={handleNext} disabled={currentIndex === slidesData.length - 1 || animState !== 'idle'} className={`p-3 rounded-full hover:bg-slate-100 transition-colors ${currentIndex === slidesData.length - 1 ? 'opacity-30' : ''}`}>
                                    <ArrowRight size={24} className="text-slate-800" />
                                </button>
                            </div>
                        )}
                        
                        {isFullScreen && currentIndex === 0 && (
                            <div className="absolute bottom-10 w-full text-center text-slate-500 font-hand text-xl animate-pulse pointer-events-none">
                                Utilisez les fl√®ches du clavier pour naviguer
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
