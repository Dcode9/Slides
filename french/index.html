<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Les Temps et La Conjugaison | Interactive Presentation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,1,0">
    <style>
        :root {
            --glass-bg: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
            --glass-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
            --primary-accent: #fbbf24;
        }

        /* --- CORE CURSOR & BASE STYLES --- */
        *, *::before, *::after { cursor: none !important; }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a;
            color: white;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            user-select: none;
        }

        /* Noise Texture */
        .bg-noise {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: -1; opacity: 0.05;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
        }

        /* Cursor Canvas */
        #cursor-canvas {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 9999;
            mix-blend-mode: exclusion;
            transition: opacity 0.2s ease;
        }

        /* Background Blobs */
        .gradient-bg {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            z-index: -2;
            background: radial-gradient(circle at 50% 50%, #1e293b, #0f172a);
            overflow: hidden;
        }
        .blob {
            position: absolute; border-radius: 50%; filter: blur(80px); opacity: 0.6;
            animation: float 20s infinite ease-in-out alternate;
            transition: all 2s ease-in-out;
        }
        .blob-1 { width: 60vw; height: 60vw; background: #4f46e5; top: -10%; left: -10%; animation-duration: 25s; }
        .blob-2 { width: 50vw; height: 50vw; background: #fbbf24; top: 40%; right: -10%; animation-duration: 22s; animation-delay: -5s; }
        .blob-3 { width: 40vw; height: 40vw; background: #ec4899; bottom: -10%; left: 20%; animation-duration: 28s; animation-delay: -10s; }
        @keyframes float {
            0% { transform: translate(0, 0) scale(1); }
            50% { transform: translate(100px, 50px) scale(1.1); }
            100% { transform: translate(-50px, 100px) scale(0.9); }
        }

        /* --- PRESENTATION ENGINE STYLES --- */

        .font-serif { font-family: 'Playfair Display', serif; }

        .view-container {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            opacity: 0; pointer-events: none;
            transition: opacity 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .view-active { opacity: 1; pointer-events: auto; }

        /* HERO TO HEADER TRANSITION LOGIC */
        .dynamic-title {
            position: absolute;
            transition: all 1.2s cubic-bezier(0.34, 1.56, 0.64, 1); /* Springier */
            z-index: 20;
            white-space: nowrap;
            letter-spacing: -0.02em;
        }
        
        /* State 0: Hero Center */
        .state-0 .dynamic-title {
            top: 50%; left: 50%;
            transform: translate(-50%, -50%) scale(1.5);
            font-size: 4rem;
            text-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        /* State 1+: Header Top Left */
        .state-header .dynamic-title {
            top: 3rem; left: 3rem;
            transform: translate(0, 0) scale(1);
            font-size: 2.5rem;
            letter-spacing: 0.05em; /* Expand slightly when small */
        }

        /* Presenter Name Transition */
        .presenter-name {
            position: absolute; top: 65%; left: 50%;
            transform: translate(-50%, 0);
            opacity: 1;
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .state-header .presenter-name {
            opacity: 0;
            transform: translate(-50%, 40px) scale(0.9);
            pointer-events: none;
        }

        /* Content Area Transition */
        .content-area {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            padding-top: 8rem;
            opacity: 0;
            transition: opacity 0.8s ease 0.4s;
        }
        .state-header .content-area { opacity: 1; }

        /* STEP ANIMATIONS (The "Pop & Unblur" Effect) */
        .step-item {
            opacity: 0;
            filter: blur(16px);
            transform: translateY(40px) scale(0.9);
            transition: all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        .step-visible {
            opacity: 1;
            filter: blur(0);
            transform: translateY(0) scale(1);
        }

        /* MIND MAP SCROLLING & HIGHLIGHTS */
        .scroll-container {
            transition: transform 1.2s cubic-bezier(0.65, 0, 0.35, 1);
        }
        
        /* Active Node Highlight in Mind Map */
        .mindmap-node {
            transition: all 0.5s ease;
            border: 2px solid transparent;
        }
        .mindmap-active {
            transform: scale(1.1);
            box-shadow: 0 0 40px rgba(251, 191, 36, 0.2);
            border-color: rgba(251, 191, 36, 0.5);
            background: rgba(255, 255, 255, 0.1);
        }

        /* Utility Classes */
        .glass-panel {
            background: var(--glass-bg);
            backdrop-filter: blur(24px); -webkit-backdrop-filter: blur(24px);
            border: 1px solid var(--glass-border);
            box-shadow: var(--glass-shadow);
            border-radius: 24px;
        }
        .glass-text {
            background: linear-gradient(135deg, #ffffff 10%, #cbd5e1 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            text-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        /* UI Controls */
        .ui-controls { transition: opacity 0.5s ease, transform 0.5s ease; }
        body.is-fullscreen .ui-controls { opacity: 0; pointer-events: none; transform: translateY(20px); }
        
        /* Pulse Animation for Nav */
        @keyframes pulse-ring {
            0% { box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(255, 255, 255, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 255, 255, 0); }
        }
        .nav-pulse { animation: pulse-ring 2s infinite; }

    </style>
</head>
<body>

    <!-- Background -->
    <div class="gradient-bg">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
        <div class="blob blob-3"></div>
    </div>
    <div class="bg-noise"></div>

    <!-- Custom Cursor -->
    <canvas id="cursor-canvas"></canvas>

    <!-- Main Content Stage -->
    <main id="stage" class="relative w-full h-full overflow-hidden">
        <!-- Slides injected via JS -->
    </main>

    <!-- Navigation Overlay -->
    <div class="ui-controls fixed bottom-0 left-0 w-full p-8 z-50 flex flex-col gap-4">
        <div class="flex justify-between items-end w-full pointer-events-auto">
            <div class="glass-panel px-4 py-2 flex items-center gap-2 cursor-pointer transition-transform hover:scale-105" onclick="toggleFullscreen()" data-hover>
                <span class="material-symbols-outlined text-white/80">aspect_ratio</span>
                <span class="text-xs font-semibold tracking-wider text-white/80">PRES. MODE</span>
            </div>

            <div class="flex gap-4">
                <button class="glass-panel w-12 h-12 flex items-center justify-center hover:bg-white/10 active:scale-90 transition-all" onclick="prevStep()" data-hover>
                    <span class="material-symbols-outlined">arrow_back</span>
                </button>
                <button id="next-btn" class="glass-panel w-12 h-12 flex items-center justify-center hover:bg-white/10 active:scale-90 transition-all nav-pulse" onclick="nextStep()" data-hover>
                    <span class="material-symbols-outlined">arrow_forward</span>
                </button>
            </div>
        </div>
        <!-- Global Slide Progress -->
        <div class="w-full h-1 bg-white/10 rounded-full overflow-hidden">
            <div id="progress" class="h-full bg-gradient-to-r from-yellow-500 to-amber-300 w-0 shadow-[0_0_15px_rgba(250,204,21,0.6)] transition-all duration-700"></div>
        </div>
    </div>

    <script>
        // --- DATA: Content & Steps ---
        const slides = [
            {
                id: 'title',
                type: 'hero',
                title: "Les Temps et<br>La Conjugaison",
                subtitle: "Mastering French Grammar",
                totalSteps: 0 
            },
            {
                id: 'present',
                type: 'standard',
                title: "Le Pr√©sent",
                presenter: "Presented by Advay Dabade",
                // Steps: 0=Hero, 1=Header Move, 2=Groups, 3=Imperative, 4=Example
                totalSteps: 4, 
                content: `
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-12 max-w-6xl mx-auto h-full items-center p-4">
                        <div class="space-y-6">
                            <div class="glass-panel p-8 step-item border-l-4 border-blue-400" data-step="2">
                                <h3 class="text-3xl text-white font-bold mb-6">The 3 Groups</h3>
                                <ul class="space-y-4 text-lg text-gray-200">
                                    <li class="flex items-center justify-between pb-2 border-b border-white/10">
                                        <span class="font-bold text-blue-300">1st Group (-ER)</span> 
                                        <span class="opacity-60 text-sm font-mono bg-white/10 px-2 py-1 rounded">Manger</span>
                                    </li>
                                    <li class="flex items-center justify-between pb-2 border-b border-white/10">
                                        <span class="font-bold text-purple-300">2nd Group (-IR)</span> 
                                        <span class="opacity-60 text-sm font-mono bg-white/10 px-2 py-1 rounded">Finir</span>
                                    </li>
                                    <li class="flex items-center justify-between pb-2 border-b border-white/10">
                                        <span class="font-bold text-yellow-300">3rd Group (-RE)</span> 
                                        <span class="opacity-60 text-sm font-mono bg-white/10 px-2 py-1 rounded">Vendre</span>
                                    </li>
                                </ul>
                            </div>
                            <div class="glass-panel p-8 step-item border-l-4 border-pink-500" data-step="3">
                                <h3 class="text-2xl text-pink-300 font-bold mb-4">L'Imp√©ratif</h3>
                                <p class="mb-4 text-sm opacity-80">The mood of command. Unique because:</p>
                                <div class="bg-pink-500/10 border border-pink-500/30 p-4 rounded-xl text-center font-mono text-pink-100">
                                    It drops the Subject Pronouns<br>
                                    <span class="text-xs opacity-60">(Tu, Nous, Vous)</span>
                                </div>
                            </div>
                        </div>
                        <div class="step-item h-full max-h-[450px]" data-step="4">
                             <div class="glass-panel p-8 h-full flex flex-col items-center justify-center bg-gradient-to-br from-blue-900/40 to-indigo-900/40 border-t-4 border-yellow-400 relative overflow-hidden">
                                <div class="absolute top-0 right-0 p-4 opacity-10"><span class="material-symbols-outlined text-9xl">compare_arrows</span></div>
                                <span class="text-xs font-bold uppercase tracking-[0.2em] text-yellow-500 mb-8 bg-black/20 px-3 py-1 rounded-full">Comparison</span>
                                
                                <div class="text-center w-full">
                                    <div class="text-3xl font-serif mb-2 text-gray-300">Tu manges.</div>
                                    <div class="text-xs uppercase tracking-widest opacity-40 mb-8 border-b border-white/10 pb-4">Indicatif (Statement)</div>
                                    
                                    <div class="text-6xl font-serif font-bold text-transparent bg-clip-text bg-gradient-to-r from-yellow-200 to-amber-500 filter drop-shadow-lg transform hover:scale-105 transition-transform duration-500">Mange !</div>
                                    <div class="text-xs uppercase tracking-widest opacity-60 mt-4 text-yellow-200/50">Imp√©ratif (Command)</div>
                                    <div class="text-[10px] mt-2 text-red-300 opacity-80">* Note: drops the 's' for -er verbs</div>
                                </div>
                             </div>
                        </div>
                    </div>
                `
            },
            {
                id: 'past',
                type: 'standard',
                title: "Le Pass√©",
                presenter: "Presented by Dhairya Shah",
                totalSteps: 4, 
                content: `
                    <div class="flex flex-col h-full max-w-5xl mx-auto pt-4 gap-6 px-4">
                        <div class="grid grid-cols-2 gap-6">
                            <div class="glass-panel p-8 step-item hover:bg-white/5 transition-colors" data-step="2">
                                <div class="flex items-center gap-4 mb-6">
                                    <div class="p-3 bg-green-500/20 rounded-full"><span class="material-symbols-outlined text-3xl text-green-400">history</span></div>
                                    <h3 class="text-2xl font-bold">Pass√© R√©cent</h3>
                                </div>
                                <div class="text-2xl font-serif text-center py-6 border border-white/10 rounded-xl bg-black/20">
                                    <span class="text-green-300">Venir de</span> + Infinitif
                                </div>
                                <p class="text-center text-sm mt-4 opacity-60 italic">"Je viens de manger" (I just ate)</p>
                            </div>

                            <div class="glass-panel p-8 step-item hover:bg-white/5 transition-colors" data-step="3">
                                <div class="flex items-center gap-4 mb-6">
                                    <div class="p-3 bg-blue-500/20 rounded-full"><span class="material-symbols-outlined text-3xl text-blue-400">done_all</span></div>
                                    <h3 class="text-2xl font-bold">Pass√© Compos√©</h3>
                                </div>
                                <div class="text-2xl font-serif text-center py-6 border border-white/10 rounded-xl bg-blue-500/10">
                                    <span class="text-blue-300">Auxiliary</span> + Participle
                                </div>
                                <p class="text-center text-sm mt-4 opacity-60 italic">"J'ai mang√©" (I ate)</p>
                            </div>
                        </div>

                        <div class="glass-panel p-8 flex-1 flex flex-col items-center justify-center step-item relative overflow-hidden border border-white/10" data-step="4">
                             <div class="absolute inset-0 bg-gradient-to-r from-purple-900/30 to-pink-900/30 z-0"></div>
                             <div class="relative z-10 w-full text-center">
                                <h4 class="text-sm uppercase tracking-[0.3em] mb-6 text-purple-200">The House of √ätre</h4>
                                <h1 class="text-5xl md:text-6xl font-bold text-white mb-8 tracking-wide drop-shadow-xl">DR MRS VANDERTRAMP</h1>
                                
                                <!-- Visual Grid of Verbs -->
                                <div class="grid grid-cols-4 md:grid-cols-8 gap-3 max-w-4xl mx-auto">
                                    ${['Devenir','Revenir','Monter','Rentrer','Sortir','Venir','Aller','Na√Ætre','Descendre','Entrer','Retourner','Tomber','Rester','Arriver','Mourir','Partir'].map(v => 
                                        `<span class="text-xs bg-white/10 p-2 rounded hover:bg-white/30 transition-colors cursor-help" data-hover>${v}</span>`
                                    ).join('')}
                                </div>
                             </div>
                        </div>
                    </div>
                `
            },
            {
                id: 'future',
                type: 'standard',
                title: "Le Futur",
                presenter: "Presented by Ishaan Mulange",
                totalSteps: 3, 
                content: `
                    <div class="flex flex-col md:flex-row items-center justify-center h-full max-w-6xl mx-auto gap-8 px-4">
                        <!-- Futur Proche -->
                        <div class="glass-panel p-10 w-full md:w-1/2 step-item group hover:bg-white/5 transition-all duration-500 border border-transparent hover:border-orange-500/30" data-step="2">
                            <div class="flex justify-between items-start">
                                <span class="material-symbols-outlined text-6xl mb-6 text-orange-400 group-hover:scale-110 transition-transform">schedule</span>
                                <span class="text-6xl font-bold opacity-10">01</span>
                            </div>
                            <h3 class="text-4xl font-bold mb-2">Futur Proche</h3>
                            <p class="text-lg opacity-60 mb-8 font-light">The immediate future.</p>
                            <div class="text-3xl font-serif text-orange-200 border-l-4 border-orange-400 pl-6 py-2 bg-gradient-to-r from-orange-500/10 to-transparent">
                                Aller + Infinitif
                            </div>
                            <div class="mt-6 text-xl opacity-80 font-mono">"Je vais manger"</div>
                        </div>

                        <!-- Futur Simple -->
                        <div class="glass-panel p-10 w-full md:w-1/2 step-item group hover:bg-white/5 transition-all duration-500 border border-transparent hover:border-purple-500/30" data-step="3">
                            <div class="flex justify-between items-start">
                                <span class="material-symbols-outlined text-6xl mb-6 text-purple-400 group-hover:scale-110 transition-transform">calendar_month</span>
                                <span class="text-6xl font-bold opacity-10">02</span>
                            </div>
                            <h3 class="text-4xl font-bold mb-2">Futur Simple</h3>
                            <p class="text-lg opacity-60 mb-8 font-light">The distant, formal future.</p>
                            <div class="text-3xl font-serif text-purple-200 border-l-4 border-purple-400 pl-6 py-2 bg-gradient-to-r from-purple-500/10 to-transparent">
                                Stem + Endings
                            </div>
                            <div class="mt-6 text-xl opacity-80 font-mono">"Je manger<span class="text-purple-400 font-bold">ai</span>"</div>
                        </div>
                    </div>
                `
            },
            {
                id: 'nuance',
                type: 'standard',
                title: "Les Nuances",
                presenter: "Presented by Rihit Kumar",
                totalSteps: 3, 
                content: `
                     <div class="flex flex-col items-center justify-center h-full max-w-4xl mx-auto space-y-6 px-4">
                        
                        <div class="w-full glass-panel p-8 flex items-center gap-8 step-item group transform hover:scale-[1.02] transition-all duration-300 border-l-8 border-indigo-400" data-step="2">
                            <div class="bg-indigo-500/20 p-6 rounded-full group-hover:bg-indigo-500/30 transition-colors">
                                <span class="material-symbols-outlined text-4xl text-indigo-300">image</span>
                            </div>
                            <div>
                                <h3 class="text-3xl font-bold text-white mb-2">L'Imparfait</h3>
                                <p class="text-lg opacity-80 font-light">Used for <span class="text-indigo-300 font-semibold">descriptions</span>, habits, or setting the scene.</p>
                                <p class="mt-3 font-mono text-sm opacity-50 border-t border-white/10 pt-2 inline-block">"Il faisait beau..." (It was nice out)</p>
                            </div>
                        </div>

                        <div class="w-full glass-panel p-8 flex items-center gap-8 step-item group transform hover:scale-[1.02] transition-all duration-300 border-l-8 border-rose-400" data-step="3">
                            <div class="bg-rose-500/20 p-6 rounded-full group-hover:bg-rose-500/30 transition-colors">
                                <span class="material-symbols-outlined text-4xl text-rose-300">psychology_alt</span>
                            </div>
                            <div>
                                <h3 class="text-3xl font-bold text-white mb-2">Le Conditionnel</h3>
                                <p class="text-lg opacity-80 font-light">Used for <span class="text-rose-300 font-semibold">politeness</span>, hypothetical situations, or "If clauses".</p>
                                <p class="mt-3 font-mono text-sm opacity-50 border-t border-white/10 pt-2 inline-block">"Je voudrais..." (I would like)</p>
                            </div>
                        </div>

                     </div>
                `
            },
            {
                id: 'mindmap',
                type: 'scroll',
                title: "The Grand Flowchart",
                totalSteps: 5, 
                content: `
                    <!-- SCROLL CONTAINER (300vh Height) -->
                    <div id="mindmap-track" class="scroll-container w-full relative flex flex-col items-center" style="height: 300vh;">
                        
                        <!-- SECTION 1: START (0vh) -->
                        <div class="h-[80vh] w-full flex flex-col items-center justify-center relative">
                            <div class="glass-panel px-12 py-10 bg-white/5 border border-white/20 shadow-2xl mindmap-node" id="node-start">
                                <h2 class="text-6xl font-bold text-transparent bg-clip-text bg-gradient-to-b from-white to-gray-400">Sentence</h2>
                                <p class="text-center mt-6 text-xl tracking-widest uppercase opacity-60">Analyze the Timeframe</p>
                            </div>
                            <div class="h-32 w-0.5 bg-gradient-to-b from-white/50 to-transparent mt-4"></div>
                        </div>

                        <!-- SECTION 2: TIMEFRAME (View 1) -->
                        <div class="h-[80vh] w-full flex items-center justify-center relative">
                            <div class="grid grid-cols-3 gap-8 w-full max-w-6xl px-8">
                                <div class="glass-panel p-8 text-center border-t-4 border-green-500 mindmap-node" id="node-past">
                                    <h3 class="text-4xl font-bold mb-2">PASS√â</h3>
                                    <p class="opacity-50 text-sm">Before Now</p>
                                </div>
                                <div class="glass-panel p-8 text-center border-t-4 border-yellow-500 scale-110 shadow-2xl bg-white/10 mindmap-node">
                                    <h3 class="text-4xl font-bold mb-2">PR√âSENT</h3>
                                    <p class="opacity-50 text-sm">Right Now</p>
                                </div>
                                <div class="glass-panel p-8 text-center border-t-4 border-purple-500 mindmap-node" id="node-future">
                                    <h3 class="text-4xl font-bold mb-2">FUTUR</h3>
                                    <p class="opacity-50 text-sm">After Now</p>
                                </div>
                            </div>
                        </div>

                        <!-- SECTION 3: PAST DECISION (View 2) -->
                        <div class="h-[80vh] w-full flex flex-col items-center justify-center relative">
                            <h2 class="text-4xl font-bold mb-16 glass-text opacity-50">Past Tense Logic</h2>
                            <div class="flex gap-8 md:gap-16">
                                <div class="glass-panel p-8 w-64 text-center step-item mindmap-node" data-step="3" id="node-recent">
                                    <div class="text-5xl mb-6">‚è™</div>
                                    <h3 class="text-xl font-bold mb-2">Recent?</h3>
                                    <p class="text-green-300 font-serif">Venir de</p>
                                </div>
                                <div class="glass-panel p-8 w-64 text-center step-item mindmap-node" data-step="3" id="node-finished">
                                    <div class="text-5xl mb-6">üé¨</div>
                                    <h3 class="text-xl font-bold mb-2">Finished?</h3>
                                    <p class="text-blue-300 font-serif">P. Compos√©</p>
                                </div>
                                <div class="glass-panel p-8 w-64 text-center step-item mindmap-node" data-step="3" id="node-desc">
                                    <div class="text-5xl mb-6">üñºÔ∏è</div>
                                    <h3 class="text-xl font-bold mb-2">Setting?</h3>
                                    <p class="text-indigo-300 font-serif">Imparfait</p>
                                </div>
                            </div>
                        </div>

                         <!-- SECTION 4: FUTURE DECISION (View 3) -->
                        <div class="h-[80vh] w-full flex flex-col items-center justify-center relative">
                            <h2 class="text-4xl font-bold mb-16 glass-text opacity-50">Future Tense Logic</h2>
                            <div class="flex gap-16">
                                <div class="glass-panel p-10 w-80 text-center step-item mindmap-node" data-step="4" id="node-proche">
                                    <h3 class="text-3xl font-bold mb-4">Intention?</h3>
                                    <div class="bg-orange-500/20 p-4 rounded-lg text-orange-200">Futur Proche</div>
                                </div>
                                <div class="glass-panel p-10 w-80 text-center step-item mindmap-node" data-step="4" id="node-simple">
                                    <h3 class="text-3xl font-bold mb-4">Promise?</h3>
                                    <div class="bg-purple-500/20 p-4 rounded-lg text-purple-200">Futur Simple</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- SECTION 5: HYPOTHETICAL (View 4) -->
                        <div class="h-[80vh] w-full flex flex-col items-center justify-center relative">
                            <div class="glass-panel p-16 text-center border-2 border-rose-500 step-item mindmap-node" data-step="5" id="node-cond">
                                <div class="bg-rose-500/20 p-6 rounded-full inline-block mb-6"><span class="material-symbols-outlined text-6xl text-rose-400">lightbulb</span></div>
                                <h2 class="text-5xl font-bold mb-4">Hypothetical?</h2>
                                <p class="text-2xl opacity-80">Use the <span class="text-rose-400 font-bold">Conditionnel</span></p>
                            </div>
                            <div class="mt-24 opacity-30 text-sm tracking-widest">FIN DU DIAPORAMA</div>
                        </div>

                    </div>
                `
            }
        ];

        // --- ENGINE STATE ---
        let currentSlideIndex = 0;
        let currentStepIndex = 0;
        const stage = document.getElementById('stage');
        const progressBar = document.getElementById('progress');

        // Initial Render
        renderSlide(currentSlideIndex);

        // --- NAVIGATION LOGIC ---
        function nextStep() {
            const slide = slides[currentSlideIndex];
            
            // Check if we can advance steps within the slide
            if (currentStepIndex < slide.totalSteps) {
                currentStepIndex++;
                updateSlideState();
            } else {
                // Steps exhausted, move to next slide
                if (currentSlideIndex < slides.length - 1) {
                    nextSlide();
                }
            }
        }

        function prevStep() {
            if (currentStepIndex > 0) {
                currentStepIndex--;
                updateSlideState();
            } else {
                if (currentSlideIndex > 0) {
                    prevSlide();
                }
            }
        }

        function nextSlide() {
            transitionSlide(currentSlideIndex + 1);
        }

        function prevSlide() {
            transitionSlide(currentSlideIndex - 1);
        }

        function transitionSlide(newIndex) {
            const currentEl = document.querySelector('.view-active');
            if(currentEl) {
                currentEl.style.opacity = '0';
                currentEl.style.transform = 'scale(0.95) translateY(-20px)'; // Enhanced exit animation
                setTimeout(() => currentEl.remove(), 800);
            }
            
            currentSlideIndex = newIndex;
            currentStepIndex = 0; // Reset steps for new slide
            renderSlide(newIndex);
            updateBackground(newIndex);
            updateProgress();
        }

        // --- RENDERING LOGIC ---
        function renderSlide(index) {
            const data = slides[index];
            const el = document.createElement('section');
            el.className = `view-container view-active`;
            el.id = `slide-${index}`; 
            
            let htmlContent = '';

            if (data.type === 'hero') {
                htmlContent = `
                    <div class="flex flex-col items-center justify-center h-full text-center p-8">
                        <h2 class="text-2xl md:text-3xl font-light text-blue-300 mb-6 tracking-widest uppercase animate-spring-up">${data.subtitle}</h2>
                        <h1 class="text-7xl md:text-9xl font-bold glass-text mb-8 animate-spring-up leading-tight filter drop-shadow-2xl">${data.title}</h1>
                    </div>
                `;
            } else if (data.type === 'standard') {
                htmlContent = `
                    <div class="relative w-full h-full overflow-hidden p-8">
                        <h1 class="dynamic-title glass-text font-bold">${data.title}</h1>
                        <div class="presenter-name glass-panel px-6 py-2 text-xl text-yellow-200 shadow-lg">${data.presenter}</div>
                        <div class="content-area">
                            ${data.content}
                        </div>
                    </div>
                `;
            } else if (data.type === 'scroll') {
                htmlContent = `
                     <div class="relative w-full h-full overflow-hidden">
                        <h1 class="absolute top-8 right-8 glass-text text-2xl font-bold z-50 opacity-50 pointer-events-none mix-blend-overlay">${data.title}</h1>
                        ${data.content}
                     </div>
                `;
            }

            el.innerHTML = htmlContent;
            stage.appendChild(el);
            
            // Trigger reflow for animation
            requestAnimationFrame(() => {
                updateSlideState();
            });
        }

        // --- STATE MANAGER (The Brain) ---
        function updateSlideState() {
            const slideEl = document.getElementById(`slide-${currentSlideIndex}`);
            const data = slides[currentSlideIndex];

            if (!slideEl) return;

            // 1. Handle "Standard" Slide Morphing (Hero to Header)
            if (data.type === 'standard') {
                if (currentStepIndex === 0) {
                    slideEl.classList.add('state-0');
                    slideEl.classList.remove('state-header');
                } else {
                    slideEl.classList.remove('state-0');
                    slideEl.classList.add('state-header');
                }
            }

            // 2. Handle Step Visibility (Pop & Unblur)
            const stepItems = slideEl.querySelectorAll('[data-step]');
            stepItems.forEach(item => {
                const itemStep = parseInt(item.getAttribute('data-step'));
                if (currentStepIndex >= itemStep) {
                    item.classList.add('step-visible');
                } else {
                    item.classList.remove('step-visible');
                }
            });

            // 3. Handle Mind Map Scrolling & Highlighting
            if (data.type === 'scroll') {
                const track = slideEl.querySelector('#mindmap-track');
                if (track) {
                    const scrollMap = [0, 0, -60, -120, -180, -240];
                    const yVal = scrollMap[currentStepIndex] || 0;
                    track.style.transform = `translateY(${yVal}vh)`;

                    // Logic to highlight nodes based on steps
                    const nodes = slideEl.querySelectorAll('.mindmap-node');
                    nodes.forEach(n => n.classList.remove('mindmap-active'));

                    // Helper to highlight by ID
                    const highlight = (id) => {
                        const n = slideEl.querySelector(`#${id}`);
                        if(n) n.classList.add('mindmap-active');
                    };

                    if (currentStepIndex === 0) highlight('node-start');
                    if (currentStepIndex === 1) { /* Just scrolling to timeframe */ } 
                    // Note: Step 2 implies the "Timeframe" view, but logic might require fine tuning based on flow
                    // Let's assume Step 2 means we are looking at Past/Present/Future
                    if (currentStepIndex === 2) highlight('node-past'); // Visual cue we are going down 'Past' path
                    if (currentStepIndex === 3) {
                         highlight('node-recent');
                         highlight('node-finished');
                         highlight('node-desc');
                    }
                    if (currentStepIndex === 4) {
                        highlight('node-proche');
                        highlight('node-simple');
                    }
                    if (currentStepIndex === 5) highlight('node-cond');
                }
            }
        }

        function updateProgress() {
            const totalStepsInApp = slides.reduce((acc, s) => acc + (s.totalSteps + 1), 0);
            // Rough calculation since we navigate slide-by-slide mostly
            // Better to stick to slide progress for simplicity or calculate global steps
            const pct = ((currentSlideIndex) / (slides.length - 1)) * 100;
            progressBar.style.width = `${pct}%`;
        }

        // --- BACKGROUND FX ---
        function updateBackground(index) {
            const blobs = document.querySelectorAll('.blob');
            blobs.forEach((blob, bIndex) => {
                const seed = (index + 1) * (bIndex + 5) * 17;
                const top = (seed % 110) - 20; 
                const left = ((seed * 31) % 110) - 20;
                blob.style.top = `${top}%`;
                blob.style.left = `${left}%`;
            });
        }

        // --- INPUT HANDLERS ---
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight' || e.key === ' ') nextStep();
            if (e.key === 'ArrowLeft') prevStep();
            if (e.key.toLowerCase() === 'p') toggleFullscreen();
        });

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else if (document.exitFullscreen) {
                document.exitFullscreen();
            }
        }
        
        document.addEventListener('fullscreenchange', () => {
            document.body.classList.toggle('is-fullscreen', !!document.fullscreenElement);
        });

        // --- PHYSICS CURSOR ENGINE ---
        const canvas = document.getElementById('cursor-canvas');
        const ctx = canvas.getContext('2d');
        
        let width, height;
        const resize = () => {
            width = window.innerWidth;
            height = window.innerHeight;
            canvas.width = width;
            canvas.height = height;
        };
        window.addEventListener('resize', resize);
        resize();

        let mouse = { x: width/2, y: height/2 };
        let cursor = { x: width/2, y: height/2, w: 20, h: 20, r: 10 };
        let velocity = { x: 0, y: 0 };
        let target = { x: width/2, y: height/2, w: 20, h: 20, r: 10 };
        let hoverEl = null;
        let hoverTimeout = null;

        window.addEventListener('mousemove', (e) => {
            mouse.x = e.clientX;
            mouse.y = e.clientY;
            
            const el = e.target.closest('[data-hover]');
            
            if (el) {
                if (hoverTimeout) { clearTimeout(hoverTimeout); hoverTimeout = null; }
                hoverEl = el;
                const rect = el.getBoundingClientRect();
                const style = window.getComputedStyle(el);
                const borderRadius = parseFloat(style.borderRadius) || 0;
                
                target.x = rect.left + rect.width / 2;
                target.y = rect.top + rect.height / 2;
                target.w = rect.width + 12;
                target.h = rect.height + 12;
                target.r = borderRadius + 6;
            } else {
                if (!hoverTimeout && hoverEl) {
                    hoverTimeout = setTimeout(() => {
                        hoverEl = null;
                        hoverTimeout = null;
                        target.w = 20; target.h = 20; target.r = 10;
                    }, 60);
                } else if (!hoverEl) {
                    target.x = mouse.x; target.y = mouse.y;
                    target.w = 20; target.h = 20; target.r = 10;
                }
            }
        });

        const loop = () => {
            const stiff = 0.2;
            const damp = 0.55;
            
            let tx = target.x;
            let ty = target.y;

            if (!hoverEl && !hoverTimeout) {
                 tx = mouse.x;
                 ty = mouse.y;
                 if (canvas.style.mixBlendMode !== 'exclusion') canvas.style.mixBlendMode = 'exclusion';
            } else {
                 if (canvas.style.mixBlendMode !== 'normal') canvas.style.mixBlendMode = 'normal';
            }

            let ax = (tx - cursor.x) * stiff;
            let ay = (ty - cursor.y) * stiff;
            
            velocity.x = (velocity.x + ax) * damp;
            velocity.y = (velocity.y + ay) * damp;

            cursor.x += velocity.x;
            cursor.y += velocity.y;

            cursor.w += (target.w - cursor.w) * 0.25;
            cursor.h += (target.h - cursor.h) * 0.25;
            cursor.r += (target.r - cursor.r) * 0.25;

            ctx.clearRect(0, 0, width, height);
            ctx.save();
            ctx.translate(cursor.x, cursor.y);

            if (!hoverEl && !hoverTimeout) {
                const speed = Math.sqrt(velocity.x**2 + velocity.y**2);
                const angle = Math.atan2(velocity.y, velocity.x);
                const stretchAmount = Math.min(Math.pow(speed * 0.04, 1.2), 0.4);
                
                ctx.rotate(angle);
                ctx.scale(1 + stretchAmount, 1 - stretchAmount);
                ctx.rotate(-angle);
            }

            const rw = cursor.w;
            const rh = cursor.h;
            const rr = Math.min(cursor.r, Math.min(rw, rh)/2);
            
            ctx.beginPath();
            ctx.roundRect(-rw/2, -rh/2, rw, rh, rr);
            
            if (hoverEl || hoverTimeout) {
                ctx.lineWidth = 3;
                ctx.strokeStyle = '#fbbf24';
                ctx.shadowColor = '#fbbf24';
                ctx.shadowBlur = 15;
                ctx.stroke();
                ctx.fillStyle = 'rgba(251, 191, 36, 0.05)';
                ctx.fill();
            } else {
                ctx.fillStyle = 'white'; 
                ctx.shadowBlur = 0;
                ctx.fill();
            }

            ctx.restore();
            requestAnimationFrame(loop);
        };
        loop();

    </script>
</body>
</html>
